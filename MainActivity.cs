/* A̬̤̣̹̱̜̟ͭ̉̋͊̑͊͑p͒ͪͩͨpͣ̽̊̃ ̻̉b̬̫͓̬͇̆̀ͩ̀́y̩͈͕͕̱̗͕ͮͫ̑ͩ̉̐̚:͖̱̥͖̤̫́̌̆͋̂̚
 
/̭̝̣̱̳̩̰̥̫̟͎͙̬*̩̤̮̥̖͇̩͙̩̝̦͍͋͒ͣ͑̃ͧ̋̊ͨͫ̅ͬͪ̚ͅͅ ̘͎͎̲̟̬̙͖͚͍͉̹̺͈͋͂̓̾̾ͨ̑ͤ̓ͧ͊̽ͤ͋ͩͅA̲͙͙̦ͮ͌ͥ̍p̝̭͙̣͙̈́ͥ͊͒̒p͖͙̖̝̘͎͙͖̣̟̙̝̺ by̩̱̖̙̲̹̘̱̱̲̼͗̒͒ͦ͒͗͋̒̃̓̔̍ͅ:̣͔͓͊ͫ͑
 ͕͎̖̺͉
 /͇̲̞̬̘ͅ*̝̦̥̹͚̔ͦͥ̑ͨ ̽̐͐̿A̼͔̬̠̮̟̭̾͐̑̂ͮ͂̚pp̫͚͕̳ ̪̻̹̓͒͆by:̤
 ̹̪̋̇

.̤͙̜̥̖̲͗ͤ̎̂ͣͬ_̯̗̠̯̰͑̒̈͆ͩ_͎̬͈̱͉̼͈ͤ̎ͥ̏̊ͪ̓ ̬͉͍̗ ͚ ͙̫͈̪̠̗ ͥ͂̍͐͛̈́ ̂ͭ ͚̰͈̬̜̭͈ͨͫ̈́̇̐̑̂ ͇͇̋̌ ̪̲ ͐ͩ͗̽ͦ ͗̌̓͐ͬ ̊  ̳̝̰ ̠͓̜̠̠͉ͣ͋ͪ̽̆́ ͒̇ͭ̉ ̦̣̫̝͚͈̫̉̂̿́͒̂̉   ̀̈́̅̎ͩ̍ ̩̹̘́̎̏  ̺̙̺͇̆̿́͋ ̜̬̭̰̉̇́̎ ͈̮ ͖̹͓̺ͣ͑ͨͥ͛ͅ ͮ̍  ̹͚ ̀̃̏ͮ̃̈́ ̼̰͕̱ ̬͒  ͖̞͖͋ͬ͂ ̯̦ͬ̾ ͐̓͊ͮ̚ ̽ͦ͒̋̋ ͖͇̈́ͩ ͭ̐͂͆̋́̾    ̺ͦ ̦̱̯͖ͥ͒͐̒ ̼͉͇̠̒̓ͮ̌ ̤̣̩̙̺ͤ͑ͮ͗ͬ.̥̟̦͖̙̠̺͊̓̏̈́͌̈́́_̤͓̱̱̜̫_͕̮̪̝ͅ_͉͙͈̠̣̻̫ͮ̅̓̀ͤ͑̓
|̼͇̠͓̙͂̏͌ͬ́ ͉̟̭̬̝̎̒́ͥ̚ ͓̼͓̙̟ͤͫ̋̈ͯ|̦̺̞̺͍̄̃̀̓ͧ_̖̰̝̬̘̲_̫̯̫͇̲̗ ̺͕̫͔̍ͧ͒̿ ̲͉̟̰̤̈́ͯͭͯ͋ ̮̯̰͚̭_̼̠͇_͗ͩ̄͛͋̉̚__ ͚̘̈́̓_ͣ̒ͨ̑̚̚_̠̼ͯ̉_  ͙͚̙̱̩͕_̆_͈̯̗̻̙̳͋ͧ̄̿͑͂_͙̠͕_͈̲͒͑_̞̹͋ͫ_̱̞ͬ͊_̻̹̪͚̘̦͋̋̍͊̍ͬ_͗͑̀ͭͯ̑  ͫ̎ ͙͉͚ ̍̄ͫͪ __̱͓̳̬̮ͅ_͉̬̦͉̩̥͈_̯̈ ̋̈̋̇̚  ̱̫ͤ̅_̜̒_̬̯̪̫̓̅ͥͭ_̬͙̟̠̭̋̓͒ͩ͑_͔̏  ̪͕̖̊̍̅̚ͅ ͔͖̼̯̃ͩͫ̓_̻̙̼̟_͔͙͉̗̦͉ͧͯͦ͌̈́̃|̭̞̞̹̙͒̈̑̋ͣ ͈͕̳̟̬̗͚̀ͫ̎ͣͫ͛ͫ_̯̬̠͇ͮ̀ͬ̚/͍̞̦͓̖̘̞̍̒̾̽ͧ̏̅
|̓͑̆̂ͪ̐̚ ͓̱̱̲̤͇͎̃̑ͣ̾͑ͤ̊ ̹̦̪͒̋͗|̗͙ͬ͌ ͔́ ̼͔͇̮̌̔̈́̓\̾̌ͪͥ̏̚_̹̲̦͎͇͈̜͑̅͑ͫ̇͋̃/̇ͩ __ \̦͔͈͇ͣ̆͌̃͐ͅ\̫͑ ͩ̇ ̗̹\͙͑/ͧ̒̍̚ ̲̤ͯ̐ /̬̳̮̣\̻͕̬̗͖̙̣̋͒̔ͯ͗͑̑_̮͑_͑̈́ ͫͩ͌ ̱̬̒̽\̀ͬͫ̍̆̔ ̓͐͑ ̀͂͗ͪ̽͌ͩ ̜͎̥̱͙ͧ͆͐̔̅/ ͑̎ͫͯ́̿_̎ͤ̐ͣͤ̾__ͥ̉͊ͥͭ\̫̠͉ͤͨ͗ ̯͉͉͍̟͈̙ͧͫ̂ͦ͐̌͛/̳̜̺̤̼̯̝  ̰̪̖͑͒͋_̲̥͈̣ͧ͒͛̌ ̗̩̞̭̖̝ͅ\̣̝̪̒̓̀̓̇ͅͅ ̣̯͎̠͈͔/͊͂ _̣͉̥̺͗̒̏̐_̾ ̹̙̹̳̈̊ͣ̚|͙͉̹̮̾ͭ͊ͫ ͍̪̻̍͆ͭ
  |̪͈͙ͪͧͬ ̞͓̟̭̻̖̙̅ͨ́ͧ̐͌͒  ̙̠̰̗̥ͣ̂͋ͩ̚Y ͈͍͙͈̺́ͪ̔͑̽ ͧ̔̋ͭͦ̓\  ̮̝̈́̋_̪̯̫̱̳͈_̙͎͙̳͕̺̩̓̓̅͋̃͐ͨ_̳̗̰̘̮̑ͥͧͤ̔/̫̮̙̳̭̭ ̟̖̄͒>̗͇̱̯̫̱ ̠̭̩̘̐̄͗̒ ̲͈͈̀ͥ̋ ̱̻͕͓̮͉͈ͭ̂̈́͛̿ͥͥ ̹̮͕͉͎̝ͬ͊̆̀̈̋͆ͅ<̬̠ͩ͋ ̮̩͙̊ͤ̒ ͦͣ͗̉/ ̞͈̣̤̰͙̟ͩ͒̓͒ͭ̔̚_͗͒͐_̳̘͑̎ ͙̮̤̜̱͙̐̊̐ͨ̋͆\_͍̖̮̜ͩ̽͗̃/ ̙̙̐ͯ/̯̳̠̬̻̯͖_͔̭̫͛͆̋/̘̌ ͇͇̫ ͤ͑̚> ͈̞̼̫̩ ̗͍̞̣̼͔͒͊̒̐̓ͮ<͖̠̪̥͔_̗̪͎̆̆͆> ̳̱̺̟ͨ̄ͣ̚)͉̘̯̋ͧ̈ ͐̌ͮ͗/̮̙͇̾ͪ͐_̣̖͕ͦ̔̀/̱̬̦̻ ͎̟̞̫͔ͦ̒͛̉ͣ|͔̹̲̬͖̬̰̀̏ͣ͐ͫͨ̓ ̬ͥ
 |_̗̰̇̄__̭ͅ|͈ ̼̣ /̳͙̓̊\̣͔̗̱̳_̤͕̻̣͎͓̀̾̆̉ͤ̚_̌_͙̺̗̅̋̿ ̎ͫ̃ ͔̜ͨ̈́>̟̲̫̣͎̝ͯ̀ͭ̾͂͊_̲̱̳_̯̬̙͍ͫ̾̍̎/̖ͭ͑ͅ\͕̱͈̣̟͎̞ͤ̈͐́͌̆̿_͕̩̫̓̔̎ \̤͙͚͇̙͆ͧ̆ͫ̆(͉͖ͭ̒_̤̹̖̖̞̖__͎̹̖̻͋͒ͦ̆_̝̰̖͔͆͛ͦ̀ ̥̻̐̽ ̪̣͙̖/\ͭ͛͂̽̂̋̊_̮͕̥̤̤̈́̽ͫ̓͊_͈̭͔̞͚̔ͥ̀͒̚_͎̜ ̟̭͔̣͋́̈́̿ ̹̰̺͍̙͈̩̔̔̀ͦ͑͛̽/͍̪̲̰̻͚ͅ \͍̺͎̭̞͓̹̒ͩ̔͂̄́̐_̮̻̳_̼̺̄͑_̱̮͍́͌̓_̗̗ͅ/̌̌̇͆\_͉͚͎̺͙̅ͦͤͧ͗_̆ͨ__̼̹̪̱̳̳͔̉̆ͨͦͯ̒͊ |͍̺ͤ̅ ̌ͨ̇
 ̲̺̘̖ͪ̊͐̄ ͔̇ ̭̞͕͓̭̣͎̌̓̿̇̃̅̚ ̮͙̲͓͖̲ͣ̋̏̂͗̒ \̙͚̳̗̝̭́̆͐͗̅ͣ̽ͅ/ͨͣ̅̓̑  ̜͕͈̺̩̺̓ͮ̈́̂ͫ͆ ̤̼̰̖̪̠ ̘̥̩̰̣̗̮͑͒ͩ͗̃͌ͥ ̣͖̐͗\̹̬̖̹̪͕̍̏̈́͊̈ͥ̚ͅ/̝͓͙̜̜͉̿ͭ̉ͩ̽̔ͪͅ ͣ͒̇̽ ̩̳͙̥ͯͧ͗ͪ  ̹̤̗̝͇̄̅͑̿̃  \̰͉ͬ̽/̩̩̻̮ͭ̀̍̒ ͚̼͓̟͍̳ ̭̞  ̞̝̞͉̠̰̾͑̓̎ͦ̂ ̮͇͈͎̫̦̖͌̑͗ͣ̉ͬ̆\//̮̥̤̱̥͚̼̍͗̍̋͑͒ͨ_̺̰̳̲̥̼̀̇͛ͮ̒̑_̼̥̫̼͈ͨ̊̍̀͆̓ͅ__̿ͭ̔_̝/  ̼̗ ͙͓̖͉̯̬̯͋̾͌̍̍͑͐ ͕̺̺̖̖ͬͤ̓̄̀ ̱̻̝̮̩̩ͅ ̭̟̒̎ ̬́ ̪̩̮͓͖̬̣͂̋̐̑̐̽̒ ̖ ̲͉̗̪̗̐ͨͫ̿̇ ̜͔̘̜̫͓̝ ̱̦͓̥͖̼ͧͫ̋̂̓ͫ ̲͕̟͍̱̳ͨͥ̍͌͗ͨ\/ ͍͎̰͙ͩ̓̊͑

 b͔͐it̻͔̖̹̭͚͒̓͒̾ͤͩc̘̝͚hut͉͍̮͉̲̃̑̆̑̒e͈̥̠ͅ.̬͖͈͙͎̝̀̇̆ͣ̍̓có̓̏̓ͫm͙͈͚̟̫̝̗ͦ͛̾ͤͤ̅̋/̳̀c͉͎͕̓̂̇ha̞̲̼͕͍͔̫̓̐͋͌̍ͫ͗n͕̦̯ͦ̂ͧne̹͙̙̟̼̼ͯͣͪ̈́́̿l͗ͣ̓̓ͧ͆/͙̬͚̯̍ͩ͌̒h̬̟̼̥e̥̹x̖̖̜̎͂͋a̹̟̟̝̞̰̳̎ͩ͋ͫ̑ͫ̈́g͕̞̻͈ͩ̍ͤͦo͚̮̰̟͓̬̱ͫͦ̾̆ͫ͛̑d͇̐
sͬ͌ou͈͕͉n͔̣̗͉ͨ͛ͫ̽dc͍̞̰̮l̻̙͇̼͔̦o̪̮u͙̤̹d̟̙͈̗̫̮̥͌̐͐ͬ̈́͑̇.̘̓c̪̹̞͙̯̮̈̌͒͋̓̓om͋̑̉̚/̇̏ͬ̑̈̈͐v̼ẙ̞̦̳̩̥ͤ͌̅͒b̯̟͚̰̎̃̃ͣe͈͔͓ͩͨͦͪͅm̲̯̤̥a̟̫͖̾̂́s̥̞̲͚̬͚̎ͣ̀̎̋̚t̮̺̹ͩ̓̽e̺͓ͣ͆r͐̒̑̿̂̍̚z̏̑̉ͥ̔

tͫ̿w̪͓͓̥ͥ͑̌̾i͈̯̲̦̠͕̿́̇ͬ̀͂t͎͓̟̥̝͍t͉̭̯̓͐̃e͉͈̖̰͇̠̓̂̓̈́̃̏r ̹͇̟̦̜̉ͪͭ̅̾@̳̘̙̗̈ͪ̾̒v̈̊̈́y̠̦̿͑bͪͧ͐̌ͩͥể̪͖̞̤̯̼̪̇͐̔̒͂yp̩͔͈̥͓̤̭̃ͧͯ͆ͭ̈́͌an͖̼̙̤̰̰ͨ͊͒ͤ̊̓ͩͅt͍̲ê͎̪̄l̝ͤo̟̰̻̼n͍̖̍ͨe͕̫͆͛z̲̮̓̿
m͋ͩͪ͂̃i͕̜̭̜nͮ͒ͫͧ͑ͭͨd̦͚̣̒̉̓̓ͅs̹̫̜͍̄́̈̋ ̲̰͛̍@̜̗̬͍̲̅͗͗͋ͨh͇̹̠͔͖̹̹ͧͪ͑͂ͤͨͬeͧ̿ͣ͊x̥̘͇͖̯̝͊̆̀̔ͥ̈́ag̲͇̬ͯ͐̐o͔͚̞̽̎̾d̼̝
s͗ͪ̅͌̚t͍ěͧ̈e͐̃̈́̃ͪͬ̐m͇͈̙̏̑̑i̙͓̰̾̊̚ṭ̩̬̼̬̠̅ͨ͐ͪ̂ͣ ͖̗̅͑@ͫ̊v͍̊ỳ̆b̼̟͉̙̲̜e̬̩̰̪̮̗͗̓̍̋́͗̿ͅṁ͊a̋͌̎ͮs̘̺̲t͎̤̖e͍̜͆̽r̠͖̙̹͍̯̀͊ͬ͒ͬ͆z
g͇̻̤͉̤̞͌̏ͨ̎̆͆a̅̀̊ͦb͔͇̱̰͙ͅ.̠͔̯a̠̜͉̦͊͑̊̿i ̳̳̞̥͈̙̽͋ͦͮ̇͊@̞͍̜͉̼̠̈́̇̐̂̄ͭh͓͓̠̙̪͌ͦ͗̓͌e̟̼̞̱̘̲ͯͦ̔̇̇ͮ̀ͅx̦̻̭̥̉̾̌ͭa͚̙͚̼͙͍g͕̣̣̣̻̀̀̆̔ͥoͥ̓̒͌͐̎̉d

b̟̠̼͕̞̙̈́ͮ̒̀͆̈́a̅̑ṣ̗͇͇̱̄̇ͭ̇̊e̅͂͗̀d̥͉̳͈̻ ̟͔͋͌ö́̀̓͆̈͛ff̻̜͍̼͖̦̔̎̿ͯ͆̆ ̎͗̅th̘̤ͧ͒e̱͐͌ͅ ͈̜̼͕ͅtͨ͒͂emplͫ̆ǎt͗ͣe̗̣̮̠ ̼͈̰̬̩̙̽͐̾ͯͯ͂b͔̫͇̱͔̹̼̃̃̂̊ͥͨͣy ̜̼͓̮̯̤̝h̎n̿̍̓̊̂ā̭̞̥͔̦̭͗ͩ̈̿͛b̞ͅb̹̮ͭ̈ǎ̘s̝̒̑ͅi̩͙̤̘ͅ
h̠͕̖̟̱t̫tͦͪ͛ͬͬ̿͑p̤̺̯͕̠̺͉̀͆̓̄̃ͦ̔s̜͈̥̖͙͒͗ͥ̆ͧ://̆g̐̑̿ͯͫ̇͌i̱̪̖̹̹̼̱͊̒͒̓̆̈́̆tͬh́̆ͥ͒ub.̣̻̭̯̟͉c͚̦̞̣͌͊ͣ̚o̖̩̦̗̬m̃̌̄̚/͈͕͛́h̹̝̥͍̰ͪ̃̒ͮͨna͎̦̻͍̰̦͇b̻̗̂͌bà̖̭ͣș̏i͓͙̤͖̘̰̣/ͅB̠̥̰͚͓̬̫ͪ̂ͦ͐͌ͩ̚ȍ̝͓͍̙̔͐͌tt̼̪̜̬̬͓om̳̜̖̜̙͆̾̒̏ͨN͓͇aṽ̪̙̰̇̌iͩ̎ͧ̄̆ͪg̬̭̠aẗͩ͋ͭͩio͔̲̯̾ͤ͆n̋̿̓ͭ͌̐Vͦiͮ̑̒͒̇͛eẁ̟̻̪̠̣̄̈̿̐P͕̜͍͕̩ag̺͈̩̹̘̹ͦ͑̓ͫ͗̀er
 ̮̱ͅ
 ͎̈́*̞̹͇ͅ/



 bitchute.com/channel/hexagod
soundcloud.com/vybemasterz

t̻͙͗̓wi͍̼̩̣͛͋ͨ͂tt͊e̫̳͍ͭͯ̐r̠̯ͦ̋ @vybeypantelonez
mi̘̠̦͔͓͒̓̊͑̂n̈́̔͋ͨ̔ͫ̓d͖̤͆ͨs̙͉̰̼ͣ̐̅̎ ̩͔̤͛͆̓@̦̬̪̰h͇̦̗͚ͅe̞̲͕̳̘̰̿̎ͦ̈́̊ͭ̆ͅx̦̼͓̳̰͍ȁ͍̣̙͓̝͂͋͗́g̫̫̦͉̠̃̍̃̆ͫó͖̭͔̦͉̬̇̽̍ͤͬd̎̄ͦ͗
s̪͌t̖͑e̯̻͐ͧe̱̅m̙̼̩̤͎̬̞i͓̦͔t͖̺̙̗͍̞ ̪͎͕̲̱ͨ̎͗̒̚@vybemasterz
g̪ͧab.̖͔͍͖̟ͤ͒͗͆̽ai̹͇̭͙̲̘ͨ͒̅ͥ̂̀ @̜̙͖͕͙̓ͯͪ̌ͩh̏ͭ̿̾e̫̼͓̠̜̭x͚̼̭̩̔͑̅ͦạ͉͓̥͋ͭ̅̒g̹̑o̗͑͌ͅd̠͙͕̤̩ͩ̾͌̽̄

b̏͒a̺̲̺s̲ḛͩd ̲͓̘͇̆̊ͨ̂ȍ̭̙̣̝̈́ͣ̅f̫̩̀̚f͔̹̯̞͓ͮ͋̔̆̃ͮͅ ̥̟ͥ̿t͍̰̗̠ͪ̍̿̓h̘͔͎̲ͅe͎ ̌̄ẗ̩͉̣̬̳̜́͆ͪͣ̄̂e͕̝̭̗̘̘̺̎͗̌ͬ̈́ͤ̒m̬͚ͦ͊ṗ̞̪͍̝̙̞̩͐̃͗̉̅̋l̼̤̲͐̓ͭåͤ̿̐̅͗t͍̠͇e̓ͥ͑ͨ͌͆ ̪̮͇̻̫ͅ hnabbasi
https://github.com/hnabbasi/BottomNavigationViewPager
 ̮̼̤̯͐̅̆̒
 *̙͓̠̲̼͆ͣ̔̒̂/

*/
using Android.OS;
using Android.Support.Design.Widget;
using Android.Support.Design.Internal;
using Android.Support.V4.View;
using BottomNavigationViewPager.Adapters;
using System.Collections.Generic;
using Android.Support.V4.App;
using BottomNavigationViewPager.Fragments;
using Android.InputMethodServices;
using Android.Views;
using Android.Content;
using Android.Webkit;
using Android.Support.V4.Content;
using static Android.Support.Design.Widget.BottomNavigationView;
using Android.Graphics;
using System.Threading.Tasks;
using BottomNavigationViewPager.Classes;
using static Android.Views.View;
using Android.Graphics.Drawables;
using System.Net;
using Java.Net;
using StartServices.Servicesclass;
using System;
using static BottomNavigationViewPager.Fragments.TheFragment5;
using System.Threading;
using Android.Content.Res;

namespace BottomNavigationViewPager
{
    //we need to set the intent filter so that links can open inapp
    [Android.App.IntentFilter(new[] { Intent.ActionView },
              Categories = new[] { Intent.CategoryBrowsable, Intent.CategoryDefault },
              DataScheme = "http",
              DataHost = "bitchute.com",
              DataPathPrefix = "",
              AutoVerify = true)]
    [Android.App.Activity(LaunchMode = Android.Content.PM.LaunchMode.SingleTop, Label = "BitChute", Theme = "@style/AppTheme", MainLauncher = true,
        ConfigurationChanges = Android.Content.PM.ConfigChanges.Orientation | Android.Content.PM.ConfigChanges.ScreenSize,
        ParentActivity = typeof(MainActivity))]

    public class MainActivity : FragmentActivity
    {
        int _tabSelected;

        public static ViewPager _viewPager;
        public static BottomNavigationView _navigationView;
        public static List<BottomNavigationItemView> _navViewItemList
            = new List<BottomNavigationItemView>();

        IMenuItem _menu;
        public static Drawable _tab4Icon;
        public static Drawable _tab5Icon;
        Fragment[] _fragments;

        public static MainActivity _main;
        public static Bundle _bundle;

        public static Globals _globals = new Globals();
        public static ExtNotifications notifications = new ExtNotifications();
        public static bool _navBarHideTimeout = false;

        //notification items:
        public static int NOTIFICATION_ID = 1000;
        public static readonly string CHANNEL_ID = "location_notification";
        public static readonly string COUNT_KEY = "count";

        public static Window _window;
        public static View _mainView;
        
        public static Java.Util.Timer _timer = new Java.Util.Timer();

        public static ISharedPreferences _prefs;
        //public static CustomAudioManager _customAudioMan = new CustomAudioManager();
        public static ExtStickyService _service = new ExtStickyService();

        WindowManagerFlags _winFlagUseHw = WindowManagerFlags.HardwareAccelerated;

        protected override void OnCreate(Bundle savedInstanceState)
        {
            _main = this;
            _window = this.Window;
            
            var mServiceIntent = new Intent(this, typeof(ExtStickyService));
            StartService(mServiceIntent);
            try
            {
                StartService(mServiceIntent);
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }

            _prefs = Android.App.Application.Context.GetSharedPreferences("BitChute", FileCreationMode.Private);
            
            base.OnCreate(savedInstanceState);

            // Set our view from the "main" layout resource
            SetContentView(Resource.Layout.Main);

            InitializeTabs();

            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_mychannel);
            _tab5Icon = _main.GetDrawable(Resource.Drawable.tab_settings);
            _viewPager = FindViewById<ViewPager>(Resource.Id.viewpager);
            _viewPager.PageSelected += ViewPager_PageSelected;
            _viewPager.Adapter = new ViewPagerAdapter(SupportFragmentManager, _fragments);

            _navigationView = FindViewById<BottomNavigationView>(Resource.Id.bottom_navigation);
            RemoveShiftMode(_navigationView);
            _navigationView.NavigationItemSelected += NavigationView_NavigationItemSelected;

            //_navigationView.LongClick += NavigationViewLongClickListener;

            _viewPager.OffscreenPageLimit = 4;

            CreateNotificationChannel();

            ExtStickyService.StartNotificationLoop(30000);
            _window.AddFlags(_winFlagUseHw);
            //_customAudioMan.GetAudioManager();
        }

        public static TheFragment1 _fm1 = TheFragment1.NewInstance("Home", "tab_home");
        public static TheFragment2 _fm2 = TheFragment2.NewInstance("Subs", "tab_subs");
        public static TheFragment3 _fm3 = TheFragment3.NewInstance("Feed", "tab_playlist");
        public static TheFragment4 _fm4 = TheFragment4.NewInstance("MyChannel", "tab_mychannel");
        public static TheFragment5 _fm5 = TheFragment5.NewInstance("Settings", "tab_home");

        void InitializeTabs()
        {
            _fragments = new Fragment[] {
                _fm1,
                _fm2,
                _fm3,
                _fm4,
                _fm5
            };
        }

        public void GetIconsFromPrefs()
        {

        }

        internal static ExtNotifications Notifications { get => notifications; set => notifications = value; }
        public static bool _navHidden = false;
        public static bool _navTimeout = true;
        public static int _navTimer = 0;

        public async void CustomOnSwipe()
        {
            if (_navTimer != 0)
                _navTimer = 0;

            if (!_navTimeout || Globals.AppState.Display._horizontal)
            {
                _navigationView.Visibility = ViewStates.Visible;
                _navHidden = false;
                NavBarRemove();
                _navTimeout = true;
                // _fm3.ShowMore();
            }
        }

        /// <summary>
        /// invoked on scroll events and hides the navbar after x seconds
        /// .. timer resets every time it's called
        /// . works with a custom scroll listener
        /// </summary>
        public void CustomOnTouch()
        { 
                if (_navTimer != 0)
                    _navTimer = 0;

            if (Globals.AppState.Display._horizontal && !Globals.AppSettings._hideHorizontalNavBar)
            {
                if (!_navTimeout)
                {
                    _navigationView.Visibility = ViewStates.Visible;
                    _navHidden = false;
                    NavBarRemove();
                    _navTimeout = true;
                    // _fm3.ShowMore();
                }
            }
            else if (!Globals.AppState.Display._horizontal)
            {
                if (_navigationView.Visibility == ViewStates.Gone)
                {
                    _navigationView.Visibility = ViewStates.Visible;
                    _navHidden = false;
                    NavBarRemove();
                    _navTimeout = true;
                }
            }
        }

        public async void NavBarRemove()
        {
            while (!_navHidden)
            {
                await Task.Delay(1000);

                _navTimer++;

                if (_navTimer >= 8)
                {
                    if (Globals.AppState.Display._horizontal)
                    {
                        _navigationView.Visibility = ViewStates.Gone;
                    }
                    _navTimeout = false;
                    _navHidden = true;
                }
            }
        }

        public override bool OnKeyDown(Android.Views.Keycode keyCode, KeyEvent e)
        {
            if (e.KeyCode == Android.Views.Keycode.Back)
            {
                switch (_viewPager.CurrentItem)
                {
                    case 0:
                        _fm1.WebViewGoBack();
                        break;
                    case 1:
                        _fm2.WebViewGoBack();
                        break;
                    case 2:
                        _fm3.WebViewGoBack();
                        break;
                    case 3:
                        _fm4.WebViewGoBack();
                        break;
                    case 4:
                        _fm5.WebViewGoBack();
                        break;
                }
            }
            return false;
        }


        void NavigationView_NavigationItemSelected(object sender, BottomNavigationView.NavigationItemSelectedEventArgs e)
        {
            _navTimer = 0;

            if (_tabSelected == e.Item.Order)
            {
                switch (_viewPager.CurrentItem)
                {
                    case 0:
                        _fm1.Pop2Root();
                        break;
                    case 1:
                        _fm2.Pop2Root();
                        break;
                    case 2:
                        _fm3.Pop2Root();
                        break;
                    case 3:
                        _fm4.Pop2Root();
                        break;
                    case 4:
                        _fm5.Pop2Root();
                        break;
                }
            }
            else
            {
                //_navigationView.SelectedItemId = e.Item.Order;
                //_menu = _navigationView.Menu.GetItem(e2.Position);
                //_navigationView.SelectedItemId = _menu.ItemId;
                _viewPager.SetCurrentItem(e.Item.Order, true);
            }
        }

        private void ViewPager_PageSelected(object sender, ViewPager.PageSelectedEventArgs e)
        {
            _navTimer = 0;

            _menu = _navigationView.Menu.GetItem(e.Position);
            _navigationView.SelectedItemId = _menu.ItemId;

            _tabSelected = _viewPager.CurrentItem;

            if (TheFragment5._fanMode)
            {
                if (TheFragment5._tab4OverridePreference != null && _tab4Icon != null)
                {
                    _navViewItemList[3].SetTitle(TheFragment5._tab4OverridePreference);
                    _navViewItemList[3].SetIcon(_tab4Icon);
                }
            }
            if (TheFragment5._settingsTabOverride)
            {
                if (TheFragment5._tab5OverridePreference != null && _tab5Icon != null)
                {
                    _navViewItemList[4].SetTitle(TheFragment5._tab5OverridePreference);
                    _navViewItemList[4].SetIcon(_tab5Icon);
                }
            }

            CustomOnSwipe();
        }

        //BottomNavigationView.NavigationItemReselectedEventArgs

        void RemoveShiftMode(BottomNavigationView view)
        {
            var menuView = (BottomNavigationMenuView)view.GetChildAt(0);

            try
            {
                var shiftingMode = menuView.Class.GetDeclaredField("mShiftingMode");
                shiftingMode.Accessible = true;
                shiftingMode.SetBoolean(menuView, false);
                shiftingMode.Accessible = false;

                for (int i = 0; i < menuView.ChildCount; i++)
                {
                    var item = (BottomNavigationItemView)menuView.GetChildAt(i);
                    item.SetShiftingMode(false);
                    // set once again checked value, so view will be updated
                    item.SetChecked(item.ItemData.IsChecked);

                    if (i == 2)
                    {
                        item.LongClick += FeedTabLongClickListener;
                    }
                    if (i == 4)
                    {
                        item.LongClick += SettingsTabLongClickListener; 
                    }
                    if (_navViewItemList != null)
                    {
                        _navViewItemList.Add(item);
                    }
                }
            }
            catch (System.Exception ex)
            {
                System.Console.WriteLine((ex.InnerException ?? ex).Message);
            }
        }

        /// <summary>
        /// forwards the setting object array to all fragments
        /// </summary>
        /// <param name="oa"></param>
        public void OnSettingsChanged(List<object> oa)
        {
            if (TheFragment5._fanMode)
            {
                //_main.TabDetailChanger();
            }
            _fm1.OnSettingsChanged(oa);
            _fm2.OnSettingsChanged(oa);
            _fm3.OnSettingsChanged(oa);
            _fm4.OnSettingsChanged(oa);
            _fm5.OnSettingsChanged(oa);
        }

        /// <summary>
        /// method to change any tab icon, title
        /// it takes the tab number integer and string change details
        /// string can be null for now can be null or blank, use "Home" "Feed" "Subs" or "Explore" with int s 3 & 4
        /// int representing tab 0 is farthest left going up to the right
        /// </summary>
        /// <param name="changeDetails"></param>
        /// <param name="tab"></param>
        /// 
        public void TabDetailChanger(int tab, string changeDetails)
        {
            switch (tab)
            {
                case 0:
                    break;
                case 1:
                    break;
                case 2:
                    break;
                case 3: 
                    if (TheFragment5._fanMode)
                    {
                        if (changeDetails == "" || changeDetails == null)
                        {
                            _navViewItemList[tab].SetTitle("MyChannel");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_mychannel));
                            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_mychannel);
                            TheFragment4._url = Globals.URLs._myChannel;
                        }
                        if (changeDetails == "Home")
                        {
                            _navViewItemList[tab].SetTitle("Home");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_home));
                            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_home);
                            TheFragment4._url = Globals.URLs._homepage;
                        }
                        if (changeDetails == "Subs")
                        {
                            _navViewItemList[tab].SetTitle("Subs");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_subs));
                            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_subs);
                            TheFragment4._url = Globals.URLs._subspage;
                        }
                        if (changeDetails == "Feed")
                        {
                            _navViewItemList[tab].SetTitle("Feed");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_playlists));
                            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_playlists);
                            TheFragment4._url = Globals.URLs._homepage;
                        }
                        if (changeDetails == "Explore")
                        {
                            _navViewItemList[tab].SetTitle("Explore");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_subs));
                            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_subs);
                            TheFragment4._url = Globals.URLs._explore;
                        }
                        _fm4.Pop2Root();
                    }
                    break;
                case 4:
                    if (TheFragment5._settingsTabOverride)
                    {
                        if (changeDetails == "" || changeDetails == null)
                        {
                            _navViewItemList[tab].SetTitle("Settings");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_settings));
                            _tab4Icon = _main.GetDrawable(Resource.Drawable.tab_settings);
                            TheFragment5._url = Globals.URLs._settings;
                        }
                        if (changeDetails == "Home")
                        {
                            _navViewItemList[tab].SetTitle("Home");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_home));
                            _tab5Icon = _main.GetDrawable(Resource.Drawable.tab_home);
                            TheFragment5._url = Globals.URLs._homepage;
                        }
                        if (changeDetails == "Subs")
                        {
                            _navViewItemList[tab].SetTitle("Subs");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_subs));
                            _tab5Icon = _main.GetDrawable(Resource.Drawable.tab_subs);
                            TheFragment5._url = Globals.URLs._subspage;
                        }
                        if (changeDetails == "Feed")
                        {
                            _navViewItemList[tab].SetTitle("Feed");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_playlists));
                            _tab5Icon = _main.GetDrawable(Resource.Drawable.tab_playlists);
                            TheFragment5._url = Globals.URLs._homepage;
                        }
                        if (changeDetails == "Explore")
                        {
                            _navViewItemList[tab].SetTitle("Explore");
                            _navViewItemList[tab].SetIcon(_main.GetDrawable(Resource.Drawable.tab_subs));
                            _tab5Icon = _main.GetDrawable(Resource.Drawable.tab_subs);
                            TheFragment5._url = Globals.URLs._explore;
                        }
                        _fm5.Pop2Root();
                    }
                    break;
            }
        }

        /// <summary>
        /// Listens for long click events on tab 4
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        public void SettingsTabLongClickListener(object sender, LongClickEventArgs e)
        {
            if (_viewPager.CurrentItem != 4)
            {
                _viewPager.CurrentItem = 4;
            }
            _fm5.ShowAppSettingsMenu();
        }

        public static bool _backgroundRequested = false;

        /// <summary>
        /// Listens for long click events on the navbar
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        public void FeedTabLongClickListener(object sender, LongClickEventArgs e)
        {
            _backgroundRequested = true;
            _main.MoveTaskToBack(true);
        }

        public Android.App.ActivityManager GetCustomActivityManager()
        {
            Android.App.ActivityManager _am = (Android.App.ActivityManager)Android.App.Application
                    .Context.GetSystemService(Context.ActivityService);
            return _am;
        }

        public static int _serviceTimer = 0;
        public static int _backgroundTimeoutInt = 0;
        public static int _backgroundLoopMsDelayInt = 3600;
        public static ExtWebInterface _extWebInterface = new ExtWebInterface();
        public static ExtNotifications _extNotifications = new ExtNotifications();

        //public override void OnWindowFocusChanged(bool hasFocus)
        //{
        //    Globals.AppState._bkgrd = true;
        //    bool _notificationStackExecutionInProgress = false;
        //    bool _backgroundNotificationTimeout = false;

        //    if (_backgroundRequested)
        //    {
        //        _service.AquireWifiLock();
        //        while (_service.IsInBkGrd())
        //        {
        //            //var afs = _service.GetAudioFocusState();

        //            _service.DummyService();

        //            Thread.Sleep(3600);
        //            //Task.Delay(3600);
        //            _backgroundTimeoutInt += 3600;

        //            if (!TheFragment5._notificationHttpRequestInProgress
        //            && !_notificationStackExecutionInProgress && !_backgroundNotificationTimeout)
        //            {
        //                _backgroundNotificationTimeout = true;
        //                _notificationStackExecutionInProgress = true;

        //                _extNotifications.DecodeHtmlNotifications(
        //                    _extWebInterface.GetBackgroundNotificationText("https://www.bitchute.com/notifications/"));
        //                _fm5.SendNotifications(_fm5.GetNotifications());
        //                _notificationStackExecutionInProgress = false;
        //            }
        //            if (ExtStickyService._notificationsHaveBeenSent)
        //            {
        //                if (_backgroundTimeoutInt >= 500000)
        //                {
        //                    _backgroundNotificationTimeout = false;
        //                    ExtStickyService._backgroundTimeout = false;
        //                    _backgroundTimeoutInt = 0;
        //                }
        //            }
        //            else
        //            {
        //                if (_backgroundTimeoutInt >= 60000)
        //                {
        //                    _backgroundNotificationTimeout = false;
        //                    ExtStickyService._backgroundTimeout = false;
        //                    _backgroundTimeoutInt = 0;
        //                }
        //            }

        //        }
        //    }
        //    _backgroundRequested = false;
        //    if (!ExtStickyService._notificationsHaveBeenSent)
        //    {
        //        _service.StartNotificationLoop(30000);
        //    }
        //}
        
        void CreateNotificationChannel()
        {
            if (Build.VERSION.SdkInt < BuildVersionCodes.O)
            {
                // Notification channels are new in API 26 (and not a part of the
                // support library). There is no need to create a notification
                // channel on older versions of Android.
                return;
            }
            
            var name = "BitChute";
            var description = "BitChute for Android";
            var channel = new Android.App.NotificationChannel(CHANNEL_ID, name, Android.App.NotificationImportance.High)
            {
                Description = description
            };

            var notificationManager = (Android.App.NotificationManager)GetSystemService(NotificationService);
            notificationManager.CreateNotificationChannel(channel);
        }
        
        protected override void OnNewIntent(Intent intent)
        {
            string url = "";
            base.OnNewIntent(intent);

            if (intent != null)
            {
                try
                {
                    url = intent.Extras.GetString("URL");
                }
                catch
                {

                }
            }
            
            try
            {

                    switch (_viewPager.CurrentItem)
                    {
                        case 0:
                            _fm1.LoadCustomUrl(url);
                            break;
                        case 1:
                            _fm2.LoadCustomUrl(url);
                            break;
                        case 2:
                            _fm3.LoadCustomUrl(url);
                            break;
                        case 3:
                            _fm4.LoadCustomUrl(url);
                            break;
                        case 4:
                            _fm5.LoadCustomUrl(url);
                            break;
                    }
                
            }
            catch 
            {

            }
        }
        
        WindowManagerFlags _winflagfullscreen = WindowManagerFlags.Fullscreen;
        WindowManagerFlags _winflagnotfullscreen = WindowManagerFlags.ForceNotFullscreen; 

        public override void OnConfigurationChanged(Configuration newConfig)
        {
            if (newConfig.Orientation == Orientation.Landscape)
            {
                _navigationView.Visibility = ViewStates.Gone;

                switch (_viewPager.CurrentItem)
                {
                    case 0:
                        if (TheFragment1._wv.Url != "https://www.bitchute.com/")
                        {
                            _fm1.LoadCustomUrl(Globals.JavascriptCommands._jsHideTitle);
                            _fm1.LoadCustomUrl(Globals.JavascriptCommands._jsHideWatchTab);
                            _fm1.LoadCustomUrl(Globals.JavascriptCommands._jsPageBarDelete);
                        }
                        TheFragment1.ExpandVideoCards(false);
                        break;
                    case 1:
                        if (TheFragment2._wv.Url != "https://www.bitchute.com/")
                        {
                            _fm2.LoadCustomUrl(Globals.JavascriptCommands._jsHideTitle);
                            _fm2.LoadCustomUrl(Globals.JavascriptCommands._jsHideWatchTab);
                            _fm2.LoadCustomUrl(Globals.JavascriptCommands._jsPageBarDelete);
                        }
                        TheFragment2.ExpandVideoCards(false);
                        break;
                    case 2:
                        if (TheFragment3._wv.Url != "https://www.bitchute.com/")
                        {
                            _fm3.LoadCustomUrl(Globals.JavascriptCommands._jsHideTitle);
                            _fm3.LoadCustomUrl(Globals.JavascriptCommands._jsHideWatchTab);
                            _fm3.LoadCustomUrl(Globals.JavascriptCommands._jsPageBarDelete);
                        }
                        TheFragment3.ExpandVideoCards(false);
                        break;
                    case 3:
                        _fm4.LoadCustomUrl(Globals.JavascriptCommands._jsHideTitle);
                        _fm4.LoadCustomUrl(Globals.JavascriptCommands._jsHideWatchTab);
                        _fm4.LoadCustomUrl(Globals.JavascriptCommands._jsPageBarDelete);
                        TheFragment4.ExpandVideoCards(false);
                        break;
                    case 4:
                        _fm5.LoadCustomUrl(Globals.JavascriptCommands._jsHideTitle);
                        _fm5.LoadCustomUrl(Globals.JavascriptCommands._jsHideWatchTab);
                        break;
                }
                Globals.AppState.Display._horizontal = true;
                _window.ClearFlags(_winflagnotfullscreen);
                _window.AddFlags(_winflagfullscreen);
            }
            if (newConfig.Orientation == Orientation.Portrait)
            {
                switch (_viewPager.CurrentItem)
                {
                    case 0:
                        _fm1.LoadCustomUrl(Globals.JavascriptCommands._jsShowTitle);
                        _fm1.LoadCustomUrl(Globals.JavascriptCommands._jsShowWatchTab);
                        _fm1.LoadCustomUrl(Globals.JavascriptCommands._jsShowPageBar);
                        break;
                    case 1:
                        _fm2.LoadCustomUrl(Globals.JavascriptCommands._jsShowTitle);
                        _fm2.LoadCustomUrl(Globals.JavascriptCommands._jsShowWatchTab);
                        _fm2.LoadCustomUrl(Globals.JavascriptCommands._jsShowPageBar);
                        break;
                    case 2:
                        _fm3.LoadCustomUrl(Globals.JavascriptCommands._jsShowTitle);
                        _fm3.LoadCustomUrl(Globals.JavascriptCommands._jsShowWatchTab);
                        _fm3.LoadCustomUrl(Globals.JavascriptCommands._jsShowPageBar);
                        break;
                    case 3:
                        _fm4.LoadCustomUrl(Globals.JavascriptCommands._jsShowTitle);
                        _fm4.LoadCustomUrl(Globals.JavascriptCommands._jsShowWatchTab);
                        _fm4.LoadCustomUrl(Globals.JavascriptCommands._jsShowPageBar);
                        break;
                    case 4:
                        _fm5.LoadCustomUrl(Globals.JavascriptCommands._jsShowTitle);
                        _fm5.LoadCustomUrl(Globals.JavascriptCommands._jsShowWatchTab);
                        _fm5.LoadCustomUrl(Globals.JavascriptCommands._jsShowPageBar);
                        break;
                }
                Globals.AppState.Display._horizontal = false;
                _window.ClearFlags(_winflagfullscreen);
                _window.AddFlags(_winflagnotfullscreen);
                CustomOnTouch();
            }

            if (!Globals.AppSettings._hideHorizontalNavBar || newConfig.Orientation == Orientation.Portrait)
            {
                _navTimeout = false;
            }

            base.OnConfigurationChanged(newConfig);

        }

        protected override void OnDestroy()
        {
            _viewPager.PageSelected -= ViewPager_PageSelected;
            _navigationView.NavigationItemSelected -= NavigationView_NavigationItemSelected;
            base.OnDestroy();
        }
    }
}
